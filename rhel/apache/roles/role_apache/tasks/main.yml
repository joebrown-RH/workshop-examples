---
- name: latest Apache version installed
  notify: apache-restart
  ansible.builtin.yum:
    name: httpd
    state: latest

- name: latest firewalld version installed
  ansible.builtin.yum:
    name: firewalld
    state: latest

- name: firewalld enabled and running
  ansible.builtin.service:
    name: firewalld
    enabled: true
    state: started

- name: firewalld permits http service
  ansible.posix.firewalld:
    service: http
    permanent: true
    state: enabled
    immediate: true

- name: Apache enabled and running
  ansible.builtin.service:
    name: httpd
    enabled: true
    state: started

- name: Ensure proper Apache configuration
  notify: apache-restart
  ansible.builtin.copy:
    src: httpd.conf
    dest: /etc/httpd/conf/httpd.conf

- name: deploy index.html
  notify: apache-restart
  ansible.builtin.template:
    src: index.html.j2
    dest: /var/www/html/index.html
